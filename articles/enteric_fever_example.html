<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="serocalculator">
<title>Enteric Fever Example • serocalculator</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Enteric Fever Example">
<meta property="og:description" content="serocalculator">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">serocalculator</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/enteric_fever_example.html">Enteric Fever Example</a>
    <a class="dropdown-item" href="../articles/sees_analysis.html">sees-analysis</a>
    <a class="dropdown-item" href="../articles/simulate_xsectionalData.html">Generate a simulated cross-sectional sample and estimate seroincidence</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/UCD-SERG/serocalculator/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Enteric Fever Example</h1>
                        <h4 data-toc-skip class="author">UC Davis
Seroepidemiology Research Group (SERG)</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/UCD-SERG/serocalculator/blob/HEAD/vignettes/articles/enteric_fever_example.Rmd" class="external-link"><code>vignettes/articles/enteric_fever_example.Rmd</code></a></small>
      <div class="d-none name"><code>enteric_fever_example.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides users with an example analysis using the
<strong>serocalculator</strong> package by reproducing an analysis in
<span class="citation">Aiemjoy et al. (2022)</span>. We review the
methods underlying the analysis and then walk through an example of
enteric fever incidence in Pakistan.</p>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>The <strong>serocalculator</strong> R package provides a rapid and
computationally simple method for calculating seroconversion rates, as
originally published in <span class="citation">Simonsen et al.
(2009)</span> and <span class="citation">Teunis et al. (2012)</span>,
and further developed by subsequent publications by <span class="citation">deGraaf et al. (2014)</span>, <span class="citation">Teunis et al. (2016)</span>, and <span class="citation">Teunis and Eijkeren (2020)</span>. In short,
longitudinal seroresponses from confirmed cases with a known symptom
onset date are assumed to represent the time course of human serum
antibodies against a specific pathogen. Therefore, by using these
longitudinal antibody dynamics with any cross–sectional sample of the
same antibodies in a human population, an incidence estimate can be
calculated. Further details are below.</p>
<div class="section level3">
<h3 id="a-proxy-for-infection">A Proxy for Infection<a class="anchor" aria-label="anchor" href="#a-proxy-for-infection"></a>
</h3>
<p>While the exact time of infection is impossible to measure in an
individual, antibody levels measured in a cross–sectional population
sample can be translated into an estimate of the frequency with which
seroconversions (infections) occur in the sampled population. So the
presence of many high antibody concentrations indicates that many people
in the population likely experienced infection recently, while mostly
low concentrations indicate a low frequency of infections in the sampled
population.</p>
<p>In order to interpret the measured cross-sectional antibody
concentrations in terms of incidence, we must define the antibody
dynamic over time to understand the generalized antibody response at
different times since infection. This dynamic must be quantified over
time to include an initial increase in serum antibody concentration when
seroconversion occurs, followed by a gradual decrease as antibodies
wane. In published studies, this information on the time course of the
serum antibody response has been obtained from longitudinal follow–up
data in cases who had a symptomatic episode following infection. In this
case, the onset of symptoms then provides a proxy for the time that
infection occurred.</p>
</div>
<div class="section level3">
<h3 id="the-seroincidence-estimator">The Seroincidence Estimator<a class="anchor" aria-label="anchor" href="#the-seroincidence-estimator"></a>
</h3>
<p>The <strong>serocalculator</strong> package was designed to calculate
the incidence of seroconversion by using the longitudinal seroresponse
characteristics. The distribution of serum antibody concentrations in a
cross–sectional population sample is calculated as a function of the
longitudinal seroresponse and the frequency of seroconversion (or
seroincidence). Given the seroresponse, this marginal distribution of
antibody concentrations can be fitted to the cross-sectional data and
thereby providing a means to estimate the seroincidence.</p>
</div>
</div>
<div class="section level2">
<h2 id="example-enteric-fever">Example: Enteric Fever<a class="anchor" aria-label="anchor" href="#example-enteric-fever"></a>
</h2>
<p>In this example, users will determine the seroincidence of enteric
fever in cross-sectional serosurveys conducted as part of the the
SErologic and Environmental Surveillance (SEES) for enteric fever study
in Bangladesh, Nepal, and Pakistan. Longitudinal antibody responses were
modeled from 1420 blood culture-confirmed enteric fever cases enrolled
from the same countries.</p>
<p>Further details on this published study can be found here: <a href="https://doi.org/10.1016/S2666-5247(22)00114-8" class="external-link uri">https://doi.org/10.1016/S2666-5247(22)00114-8</a>.</p>
<div class="section level3">
<h3 id="load-packages">Load packages<a class="anchor" aria-label="anchor" href="#load-packages"></a>
</h3>
<p>The first step in conducting this analysis is to load our necessary
packages.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/UCD-SERG/serocalculator" class="external-link">serocalculator</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="load-data">Load data<a class="anchor" aria-label="anchor" href="#load-data"></a>
</h3>
<p>Pathogen-specific sample datasets, noise parameters, and longitudinal
antibody dynamics for <strong>serocalculator</strong> are available on
the <a href="https://osf.io/ne8pc/" class="external-link">Serocalculator Repository</a> on
Open Science Framework (OSF). We use the function
<code>getAdditionalData</code> to pull this data into our R
environment.</p>
<div class="section level4">
<h4 id="load-and-prepare-longitudinal-parameter-data">Load and prepare longitudinal parameter data<a class="anchor" aria-label="anchor" href="#load-and-prepare-longitudinal-parameter-data"></a>
</h4>
<p>We will first load the longitudinal curve parameters to set the
antibody decay parameters. In this example, these parameters were
modeled with Bayesian hierarchical models to fit two-phase
power-function decay models to the longitudinal antibody responses among
confirmed enteric fever cases.</p>
<p>These parameters include the following:</p>
<ul>
<li>
<span class="math inline">\(y_0\)</span> = baseline antibody
response</li>
<li>
<span class="math inline">\(y_1\)</span> = peak antibody
responses</li>
<li>
<span class="math inline">\(t_1\)</span> = time to peak</li>
<li>
<span class="math inline">\(\alpha\)</span> = decay rate in years
(may need to be rescaled)</li>
<li>
<span class="math inline">\(r\)</span> = decay shape</li>
</ul>
<p>We also create an additional variables <span class="math inline">\(d\)</span>, which is the decay shape, or 1-<span class="math inline">\(r\)</span>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Import longitudinal antibody parameters from OSF</span></span>
<span></span>
<span><span class="va">curve_param</span> <span class="op">=</span> <span class="fu"><a href="../reference/getAdditionalData.html">getAdditionalData</a></span><span class="op">(</span>fileURL <span class="op">=</span><span class="st">"https://osf.io/download/rtw5k/"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="load-and-prepare-cross-sectional-data">Load and prepare cross-sectional data<a class="anchor" aria-label="anchor" href="#load-and-prepare-cross-sectional-data"></a>
</h4>
<p>Next, we load our sample cross-sectional data. We will use a subset
of results from the SEES dataset. Ideally, this will be a representative
sample of the general population without regard to disease status.
Later, we will limit our analysis to cross-sectional data from
Pakistan.</p>
<p>We have selected hemolysin E (<em>HlyE</em>) as our target antigen
and <em>IgG</em> and <em>IgA</em> as our target immunoglobulin isotypes.
Users may select different serologic markers depending on what is
available in your data. From the original dataset, we rename our result
and age variables to the names required by
<strong>serocalculator</strong>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Import cross-sectional data from OSF</span></span>
<span></span>
<span><span class="va">pop_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getAdditionalData.html">getAdditionalData</a></span><span class="op">(</span>fileURL <span class="op">=</span><span class="st">"https://osf.io/download//n6cp3/"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">result</span>,</span>
<span>         age <span class="op">=</span> <span class="va">Age</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="visualize-antibody-data">Visualize antibody data<a class="anchor" aria-label="anchor" href="#visualize-antibody-data"></a>
</h4>
<p>We examine our cross-sectional antibody data by visualizing the
distribution of quantitative antibody responses. Here, we will look at
the distribution of our selected antigen and isotype pairs, HlyE IgA and
HlyE IgG, across participating countries.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Create histograms</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pop_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_histogram(binwidth = 5, color = "#000000", fill = "#009999", alpha = 0.7) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Country</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.7</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribution of Cross-sectional Antibody Responses"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Antibody Response Value"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Country</span> <span class="op">+</span> <span class="va">antigen_iso</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="enteric_fever_example_files/figure-html/hist-1.png" width="700"></p>
<p>We see that across countries, our data is highly skewed with the
majority of responses on the lower end of our data with long tails.
Let’s get a better look at the distribution by log transforming our
antibody response value. We will also need to update the bin width.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Create log transformed histograms</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">pop_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co">#geom_histogram(binwidth = 0.05, color = "#000000", fill = "#009999", alpha = 0.7) +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="va">Country</span><span class="op">)</span>, alpha <span class="op">=</span> <span class="fl">.7</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html" class="external-link">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Distribution of Cross-sectional Antibody Responses (Log transformed)"</span>,</span>
<span>    x <span class="op">=</span> <span class="st">"Log10(Antibody Response Value)"</span>,</span>
<span>    y <span class="op">=</span> <span class="st">"Frequency"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">Country</span> <span class="op">+</span> <span class="va">antigen_iso</span>, nrow <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Transformation introduced infinite values in continuous x-axis</span></span>
<span><span class="co">#&gt; Warning: Removed 18 rows containing non-finite values (`stat_bin()`).</span></span></code></pre></div>
<p><img src="enteric_fever_example_files/figure-html/loghist-1.png" width="700"></p>
<p>Once log transformed, our data looks much more normally distributed.
In most cases, log transformation will be the best way to visualize
serologic data.</p>
</div>
</div>
<div class="section level3">
<h3 id="load-noise-parameters">Load noise parameters<a class="anchor" aria-label="anchor" href="#load-noise-parameters"></a>
</h3>
<p>Next, we must set conditions based on some assumptions about the data
and error that may need to obe accounted for. This will differ based on
background knowledge of the data.</p>
<p>The biological noise, <span class="math inline">\(\nu\)</span>
(“nu”), represents error from cross-reactivity to other antibodies.
Measurement noise, <span class="math inline">\(\varepsilon\)</span>
(“epsilon”), represents error from the laboratory testing process.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Import noise parameters from OSF</span></span>
<span></span>
<span><span class="va">noise_param</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getAdditionalData.html">getAdditionalData</a></span><span class="op">(</span>fileURL <span class="op">=</span><span class="st">"https://osf.io/download//hqy4v/"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>y.low <span class="op">=</span> <span class="va">llod</span><span class="op">)</span> <span class="co">#rename lower bound</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="estimate-seroincidence">Estimate Seroincidence<a class="anchor" aria-label="anchor" href="#estimate-seroincidence"></a>
</h2>
<p>Finally, we are ready to begin seroincidence estimation. We will
conduct two separate analyses using two distinct functions,
<code>est.incidence</code> and <code>est.incidence.by</code>, to
calculate the overall seroincidence and the stratified seroincidence,
respectively.</p>
<div class="section level3">
<h3 id="overall-seroincidence">Overall Seroincidence<a class="anchor" aria-label="anchor" href="#overall-seroincidence"></a>
</h3>
<p>Using the function <code>est.incidence</code>, we define our starting
value as 0.2, which will also define our initial estimate for the force
of infection (FOI, <span class="math inline">\(\lambda\)</span>
(“lambda”)). We filter to Pakistan and define the datasets for our
cross-sectional data (data), longitudinal parameters (curve_param), and
noise parameters (noise_param). We also define the antigen-isotype pairs
to be included in the estimate.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Using est.incidence (no strata)</span></span>
<span></span>
<span><span class="va">esttest</span> <span class="op">=</span> <span class="fu"><a href="../reference/est.incidence.html">est.incidence</a></span><span class="op">(</span></span>
<span>  stepmax <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lambda_start<span class="op">=</span><span class="fl">.2</span>,</span>
<span>  pop_data <span class="op">=</span> <span class="va">pop_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">==</span> <span class="st">"Pakistan"</span><span class="op">)</span>,</span>
<span>  curve_param <span class="op">=</span> <span class="va">curve_param</span>, </span>
<span>  noise_param <span class="op">=</span> <span class="va">noise_param</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">==</span> <span class="st">"Pakistan"</span><span class="op">)</span>,</span>
<span>  antigen_isos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HlyE_IgG"</span>, <span class="st">"HlyE_IgA"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; iteration = 0</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.609438</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 2434.836</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] 112.9062</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 1</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] -0.3013201</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.910758</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 2420.488</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -14.00558</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 2</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0.03325271</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.877505</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 2420.236</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -1.099217</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 3</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0.002832087</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.874673</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 2420.234</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] 0.01306674</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 4</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.874706</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 2420.234</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -1.358391e-05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative gradient close to zero.</span></span>
<span><span class="co">#&gt; Current iterate is probably solution.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  17.457   0.000  17.458</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">esttest</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 10</span></span></span>
<span><span class="co">#&gt;   est.start incidence.rate      SE CI.lwr CI.upr coverage log.lik iterations</span></span>
<span><span class="co">#&gt;       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>       0.2          0.153 0.007<span style="text-decoration: underline;">74</span>  0.139  0.169     0.95  -<span style="color: #BB0000; text-decoration: underline;">2</span><span style="color: #BB0000;">420.</span>          4</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 2 more variables: antigen.isos &lt;chr&gt;, nlm.convergence.code &lt;ord&gt;</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="stratified-seroincidence">Stratified Seroincidence<a class="anchor" aria-label="anchor" href="#stratified-seroincidence"></a>
</h3>
<p>We can also produce stratified seroincidence estimates. Here we
stratify by catchment area within Pakistan, but users can select any
stratification variable.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Using est.incidence.by (strata)</span></span>
<span></span>
<span><span class="va">estbytest</span> <span class="op">=</span> <span class="fu"><a href="../reference/est.incidence.by.html">est.incidence.by</a></span><span class="op">(</span></span>
<span>  stepmax <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lambda_start<span class="op">=</span><span class="fl">.3</span>,</span>
<span>  strata <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"catchment"</span><span class="op">)</span>,</span>
<span>  pop_data <span class="op">=</span> <span class="va">pop_data</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">==</span> <span class="st">"Pakistan"</span><span class="op">)</span>,</span>
<span>  curve_params <span class="op">=</span> <span class="va">curve_param</span>, </span>
<span>  noise_params <span class="op">=</span> <span class="va">noise_param</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Country</span> <span class="op">==</span> <span class="st">"Pakistan"</span><span class="op">)</span>,</span>
<span>  build_graph <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in warn.missing.strata(data = curve_params, strata = select(strata, : curve_params is missing all strata variables, and will be used unstratified.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To avoid this warning, specify the desired set of stratifying variables in the `curve_strata_varnames` and `noise_strata_varnames` arguments to `est.incidence.by()`.</span></span>
<span><span class="co">#&gt; Warning in warn.missing.strata(data = noise_params, strata = select(strata, : noise_params is missing all strata variables, and will be used unstratified.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; To avoid this warning, specify the desired set of stratifying variables in the `curve_strata_varnames` and `noise_strata_varnames` arguments to `est.incidence.by()`.</span></span>
<span><span class="co">#&gt;     Stratum catchment   n</span></span>
<span><span class="co">#&gt; 1 Stratum 1       aku 294</span></span>
<span><span class="co">#&gt; 2 Stratum 2       kgh 200</span></span>
<span><span class="co">#&gt;     Stratum catchment   n</span></span>
<span><span class="co">#&gt; 1 Stratum 1       aku 294</span></span>
<span><span class="co">#&gt; iteration = 0</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.203973</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1453.51</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] 241.4326</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 1</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] -1</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -2.203973</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1357.35</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -25.56654</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 2</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0.09575513</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -2.108218</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1355.804</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -6.473402</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 3</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0.03246515</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -2.075753</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1355.704</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] 0.3352425</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 4</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] -0.001598512</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -2.077351</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1355.703</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -0.003983894</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 5</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -2.077332</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1355.703</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -2.955276e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative gradient close to zero.</span></span>
<span><span class="co">#&gt; Current iterate is probably solution.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  11.376   0.000  11.376 </span></span>
<span><span class="co">#&gt;     Stratum catchment   n</span></span>
<span><span class="co">#&gt; 1 Stratum 2       kgh 200</span></span>
<span><span class="co">#&gt; iteration = 0</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.203973</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1066.923</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] 73.03752</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 1</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] -0.4114013</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.615374</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1053.236</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -4.498946</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 2</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0.02387099</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.591503</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1053.178</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -0.3483076</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 3</span></span>
<span><span class="co">#&gt; Step:</span></span>
<span><span class="co">#&gt; [1] 0.002003173</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.5895</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1053.177</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] 0.002194632</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; iteration = 4</span></span>
<span><span class="co">#&gt; Parameter:</span></span>
<span><span class="co">#&gt; [1] -1.589512</span></span>
<span><span class="co">#&gt; Function Value</span></span>
<span><span class="co">#&gt; [1] 1053.177</span></span>
<span><span class="co">#&gt; Gradient:</span></span>
<span><span class="co">#&gt; [1] -1.716554e-06</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Relative gradient close to zero.</span></span>
<span><span class="co">#&gt; Current iterate is probably solution.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   6.816   0.000   6.816 </span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  19.642   0.000  19.642</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">estbytest</span><span class="op">)</span></span>
<span><span class="co">#&gt; Seroincidence estimated given the following setup:</span></span>
<span><span class="co">#&gt; a) Antigen isotypes   : HlyE_IgA, HlyE_IgG </span></span>
<span><span class="co">#&gt; b) Strata       : catchment </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Seroincidence estimates:</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 13</span></span></span>
<span><span class="co">#&gt;   Stratum   catchment     n est.start incidence.rate      SE CI.lwr CI.upr</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Stratum 1 aku         294       0.3          0.125 0.008<span style="text-decoration: underline;">60</span>  0.109  0.143</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Stratum 2 kgh         200       0.3          0.204 0.015<span style="text-decoration: underline;">4</span>   0.176  0.237</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 5 more variables: coverage &lt;dbl&gt;, log.lik &lt;dbl&gt;, iterations &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   antigen.isos &lt;chr&gt;, nlm.convergence.code &lt;ord&gt;</span></span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h2>
<p>In our data, we find that the overall estimated seroincidence of
enteric fever in Pakistan is 13.7 per 100 persons (95% CI: 12.4, 15.1).
When stratified by catchment area, we find that area KGH has a higher
incidence rate than area AKU [18.6 per 100 persons (95% CI: 16.0, 21.5)
vs. 11.1 per 100 persons (95% CI: 9.7, 12.7).</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Aiemjoy_2022_Lancet" class="csl-entry">
Aiemjoy, K., Seidman J. C., Saha S., Munira S. J., Islam Sajib M. S.,
and Sarkar Sium S. M. al. 2022. <span>“Estimating Typhoid Incidence from
Community-Based Serosurveys: A Multicohort Study.”</span> <em>The Lancet
Microbe</em> 3 (8): e578–87. <a href="https://doi.org/10.1016/S2666-5247(22)00114-8" class="external-link">https://doi.org/10.1016/S2666-5247(22)00114-8</a>.
</div>
<div id="ref-de_Graaf_2014" class="csl-entry">
deGraaf, W. F., M. E. E. Kretzschmar, P. F. M. Teunis, and O. Diekmann.
2014. <span>“A Two-Phase Within-Host Model for Immune Response and Its
Application to Serological Profiles of Pertussis.”</span>
<em>Epidemics</em> 9 (December): 1–7. <a href="https://doi.org/10.1016/j.epidem.2014.08.002" class="external-link">https://doi.org/10.1016/j.epidem.2014.08.002</a>.
</div>
<div id="ref-Simonsen_2009" class="csl-entry">
Simonsen, J., K. Mølbak, G. Falkenhorst, K. A. Krogfelt, A. Linneberg,
and P. F. M. Teunis. 2009. <span>“Estimation of Incidences of Infectious
Diseases Based on Antibody Measurements.”</span> <em>Statistics in
Medicine</em> 28 (14): 1882–95. <a href="https://doi.org/10.1002/sim.3592" class="external-link">https://doi.org/10.1002/sim.3592</a>.
</div>
<div id="ref-Teunis_2020" class="csl-entry">
Teunis, P. F. M., and J. C. H. van Eijkeren. 2020. <span>“Estimation of
Seroconversion Rates for Infectious Diseases: Effects of Age and
Noise.”</span> <em>Statistics in Medicine</em> 39 (21): 2799–2814. <a href="https://doi.org/10.1002/sim.8578" class="external-link">https://doi.org/10.1002/sim.8578</a>.
</div>
<div id="ref-Teunis_2016" class="csl-entry">
Teunis, P. F. M., J. C. H. van Eijkeren, W. F. de Graaf, A. Bonačić
Marinović, and M. E. E. Kretzschmar. 2016. <span>“Linking the
Seroresponse to Infection to Within-Host Heterogeneity in Antibody
Production.”</span> <em>Epidemics</em> 16 (September): 33–39. <a href="https://doi.org/10.1016/j.epidem.2016.04.001" class="external-link">https://doi.org/10.1016/j.epidem.2016.04.001</a>.
</div>
<div id="ref-Teunis_2012" class="csl-entry">
Teunis, P. F. M., JCH van Eijkeren, CW Ang, YTHP van Duynhoven, JB
Simonsen, MA Strid, and W van Pelt. 2012. <span>“Biomarker Dynamics:
Estimating Infection Rates from Serological Data.”</span> <em>Statistics
in Medicine</em> 31 (20): 2240–48. <a href="https://doi.org/10.1002/sim.5322" class="external-link">https://doi.org/10.1002/sim.5322</a>.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Peter Teunis, Kristina Lai, Kristen Aiemjoy, Douglas Ezra Morrison.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
